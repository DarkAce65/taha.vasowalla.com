<!DOCTYPE html>
<html>
	<head>
		<title>xkcd Scraper</title>
		<link rel="shortcut icon" href="img/icons/xkcdIcon.png"/>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="railscasts.css"/>
		<script src="highlight.pack.js"></script>
		<script>
			function init() {
				hljs.highlightBlock(document.querySelector(".python"));
			}
		</script>
	</head>
	<body onload="init()" class="hljs" style="font-family: monospace;">
        <div class="python" style="white-space: pre; overflow: visible;">import urllib
from lxml import html
import requests
from lxml import etree

imagetitle = []
imagetranscript = []
imageurl = []
imagealt = []
imageid = []
n = 1547

def scrape():
    for i in range(n):
        istr = str(i)
        url = 'http://xkcd.com/'
        print (url+istr)
        page = requests.get(url+istr);
        print(page)
        tree = html.fromstring(page.content)
        imagealt.append(tree.xpath('//div[@id="comic"]//img/@title'))
        imagetranscript.append(tree.xpath('//div[@id="transcript"]/text()'))
        imageurl.append(tree.xpath('//div[@id="comic"]//img/@src'))
        imagetitle.append(tree.xpath('//div[@id="comic"]//img/@alt'))
        imageid.append(i)

def maketext():
    f = open('xkcdData.txt','w')
    for i in range(1,n):
        f.write(str(imageid[i]))
        f.write('\n')
        f.write(str(imagetitle[i]).strip("['']"))
        f.write('\n')
        f.write(str(imageurl[i]).strip("[//'']"))
        f.write('\n')
        f.write(str(imagealt[i]).strip("[]"))
        f.write('\n')
        f.write(str(imagetranscript[i]).strip("[]"))
        f.write('\n')
    f.close()


scrape()
maketext()</div>
	</body>
</html>