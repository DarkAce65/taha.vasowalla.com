<!DOCTYPE html>
<html>
	<head>
		<title>xkcd Search Engine</title>
		<link rel="shortcut icon" href="img/icons/xkcdIcon.png"/>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" href="Stylesheet.css"/>
		<link rel="stylesheet" type="text/css" href="themes/light.css"/>
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<script src="bower_components/jquery-unveil/jquery.unveil.min.js"></script>
		<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<style>
			#output img {
				opacity: 0;
				transition: opacity .3s ease-in;
			}
		</style>
	</head>
	<body id="xkcdBody">
		<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="index.html"><i class="fa fa-home fa-fw"></i> Everything Taha</a>
				</div>
				<div id="collapse" class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li><a href="About.html">About Me</a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right hidden-xs">
						<li><a href="https://www.facebook.com/taha.vasowalla" target="_blank" class="fa fa-fw fa-facebook"></a></li>
						<li><a href="https://www.google.com/+TahaVasowalla/about" target="_blank" class="fa fa-fw fa-google-plus"></a></li>
						<li><a href="http://instagram.com/darkace65/" target="_blank" class="fa fa-fw fa-instagram"></a></li>
						<li><a href="https://www.linkedin.com/in/TahaVasowalla" target="_blank" class="fa fa-fw fa-linkedin"></a></li>
						<li><a href="https://github.com/DarkAce65" target="_blank" class="fa fa-fw fa-github"></a></li>
						<li><p class="navbar-text">Designed and Built by Taha Vasowalla</p></li>
					</ul>
				</div>
			</div>
		</nav>
		<div class="fixedNav content container" style="text-align: center;">
			<div id="searchContainer">
				<img id="logo" src="http://imgs.xkcd.com/static/terrible_small_logo.png" alt="xkcd logo">
				<h2>Search Engine</h2>
				<input id="searchInput" type="text" placeholder="Enter keyword...">
				<button id="search" onclick="search();" data-loading-text="Loading...">Search</button>
				<p id="error" class="hidden">Search query must be at least 3 characters long.</p>
				<p>Concept and python <a href="xkcdScraper.html">scraper</a> by Amit Deliwala.</p>
				<p>All comics from <a href="http://xkcd.com/" target="_blank">xkcd.com</a>.</p>
			</div>
			<div id="output"></div>
		</div>
		<footer class="footer">
			<nav class="nav">
				<p>Designed and Built by Taha Vasowalla</p>
				<a href="https://www.facebook.com/taha.vasowalla" target="_blank" class="fa fa-fw fa-facebook"></a>
				<a href="https://www.google.com/+TahaVasowalla/about" target="_blank" class="fa fa-fw fa-google-plus"></a>
				<a href="http://instagram.com/darkace65/" target="_blank" class="fa fa-fw fa-instagram"></a>
				<a href="https://www.linkedin.com/in/TahaVasowalla" target="_blank" class="fa fa-fw fa-linkedin"></a>
				<a href="https://github.com/DarkAce65" target="_blank" class="fa fa-fw fa-github"></a>
			</nav>
		</footer>
		<script type="text/javascript">
			var id = [], titles = [], url = [], alt = [], transcript = [];
			var txtData = [];

			function sort(data) {
				for(var i = 0; i < data.length; i = i + 5) {
					var index = Math.round(i / 5);
					id[index] = data[i];
					titles[index] = data[i + 1];
					url[index] = data[i + 2];
					alt[index] = data[i + 3];
					transcript[index] = data[i + 4];
				}


				$("#search").button("reset");
				$("#searchInput").keypress(function(e) {
					if(e.which == 13) {
						$("#search").click();
						$("#search").focus();
					}
				});
			}

			function search() {
				$("#output").html("");
				var query = $("#searchInput").val().toLowerCase();
				var i = parseInt(query, 10) - 1;

				if(typeof i == "number" && i !== NaN && i < id.length) {
					$("#error").addClass("hidden");
					var comic = $('<div class="comic"><h3 class="title">' + titles[i] + '<span class="subtitle">Comic ' + id[i] + '</span></h3><div class="image"><img src="" data-src="http://' + url[i] + '" title=' + alt[i] + '></div></div><br>');
					$("#output").append(comic);
					comic.find("img").unveil(200, function() {
						$(this).load(function() {
							this.style.opacity = 1;
						});
					});
				}
				else if(query.length < 3) {
					$("#error").removeClass("hidden");
				}

				if(query.length >= 3) {
					$("#error").addClass("hidden");
					var found = false;
					for(var i = 0; i < id.length; i++) {
						found = false;
						if(titles[i] != null) {
							if(titles[i].toLowerCase().indexOf(query) != -1) {
								found = true;
							}
						}
						if(transcript[i] != null) {
							if(transcript[i].toLowerCase().indexOf(query) != -1) {
								found = true;
							}
						}
						if(found) {
							var comic = $('<div class="comic"><h3 class="title">' + titles[i] + '<span class="subtitle">Comic ' + id[i] + '</span></h3><div class="image"><img src="" data-src="http://' + url[i] + '" title=' + alt[i] + '></div></div><br>');
							$("#output").append(comic);
							comic.find("img").unveil(200, function() {
								$(this).load(function() {
									this.style.opacity = 1;
								});
							});
						}
					}
					if($("#output").html() == "") {
						$("#output").append('<div class="comic col-xs-12 col-sm-6 col-sm-offset-3"><h3 class="title">No results found.</h3></div>');
					}
				}
			}

			$("#search").button("loading");
			$.get("xkcdData.txt", function(response) {
				txtData = response.split("\n");
				sort(txtData);
			});
		</script>
	</body>
</html>