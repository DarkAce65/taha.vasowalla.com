<!DOCTYPE html>
<html>
	<head>
		<title>Hangman</title>
		<link rel="shortcut icon" href="img/icons/Hangman.png"/>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="bower_components/font-awesome/css/font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" href="bower_components/bootstrap-sweetalert/lib/sweet-alert.css"/>
		<link rel="stylesheet" type="text/css" href="Stylesheet.css"/>
		<link rel="stylesheet" type="text/css" href="themes/light.css"/>
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="lib/GSAP/TweenMax.min.js"></script>
		<script src="lib/GSAP/plugins/DrawSVGPlugin.min.js"></script>
		<script src="bower_components/bootstrap-sweetalert/lib/sweet-alert.min.js"></script>
	</head>
	<body id="hangmanBody">
		<nav class="navbar navbar-default navbar-static-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="index.html"><i class="fa fa-home fa-fw"></i> Everything Taha</a>
				</div>
				<div id="collapse" class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li><a href="About.html">About Me</a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right hidden-xs">
						<li><a href="https://www.facebook.com/taha.vasowalla" target="_blank"><i class="fa fa-fw fa-facebook"></i></a></li>
						<li><a href="https://www.google.com/+TahaVasowalla/about" target="_blank"><i class="fa fa-fw fa-google-plus"></i></a></li>
						<li><a href="http://instagram.com/darkace65/" target="_blank"><i class="fa fa-fw fa-instagram"></i></a></li>
						<li><a href="https://www.linkedin.com/in/TahaVasowalla" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a></li>
						<li><a href="https://github.com/DarkAce65" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
						<li><p class="navbar-text hidden-sm">Designed and Built by Taha Vasowalla</p></li>
					</ul>
				</div>
			</div>
		</nav>
		<div class="content container">
			<div id="wordDialog" class="modal fade" data-keyboard="false" data-backdrop="static">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button class="close" data-dismiss="modal"><span>&times;</span></button>
							<h4 class="modal-title">Enter your word below</h4>
						</div>
						<div class="modal-body">
							<span class="fancyInput">
								<input id="wordInput" type="password">
								<label for="wordInput" class="floatingLabel">
									<span class="labelContent">Word</span>
								</label>
							</span>
							<p id="error" style="color: red; display: none;">Your word contains invalid characters. Only letters are accepted.</p>
							<p style="text-align: right;"><button id="submitWord" class="btn btn-primary">Go!</button></p>
						</div>
					</div>
				</div>
			</div>
			<div class="page-header">
				<p class="h1">Hangman</p>
			</div>
			<div class="row">
				<svg id="hangmanSVG" viewBox="0 0 500 400" class="col-xs-7 col-sm-8 col-md-6 col-md-offset-1">
					<path id="base" style="fill: none; stroke: black;" d="m 52.567061,362.68341 c 88.653899,-29.13563 197.359959,-17.43136 278.732599,4.8749"></path>
					<path id="gallow" style="fill: none; stroke: black;" d="m 143.44166,345.45176 c 10.88005,-103.29584 11.68263,-208.83798 14.14214,-312.13713 82.3107,-8.19067 165.55984,-11.1117 248.49747,-11.1117 -0.27648,13.64776 -1.34605,26.92097 -2.0203,40.4061"></path>
					<g id="man">
						<path id="rLeg" style="fill: none; stroke: black;" d="m 411.3892,235.7377 c 15.23931,17.1561 17.75142,48.02831 24.34193,69.7654"></path>
						<path id="lLeg" style="fill: none; stroke: black;" d="m 412.16038,235.78408 c -4.90664,25.6128 -14.93038,50.305 -23.94217,74.7332"></path>
						<path id="rArm" style="fill: none; stroke: black;" d="m 400.61306,116.44399 c 17.06809,19.19532 26.85158,38.1177 33.04254,74.68829"></path>
						<path id="lArm" style="fill: none; stroke: black;" d="m 398.29597,117.58622 c -3.27985,28.78639 -14.14214,53.78348 -14.14214,82.83251"></path>
						<path id="body" style="fill: none; stroke: black;" d="m 399.64285,116.42857 12.5,120.35714"></path>
						<path id="head" style="fill: none; stroke: black;" d="m 392.19072,67.57406 c -65.92616,96.50587 108.15832,29.76716 3.94514,-8.87456"></path>
					</g>
					<g id="xEyes">
						<path style="fill: none; stroke: black;" d="m 391.93919,86.18434 c -1.69509,2.28862 -3.75231,4.83465 -5.55584,6.81853"></path>
						<path style="fill: none; stroke: black;" d="m 386.88843,86.94196 c 2.55432,1.43504 4.2581,4.04221 5.55584,6.06091"></path>
						<path style="fill: none; stroke: black;" d="m 411.8897,81.63866 c -0.1828,2.6209 -2.30291,4.40199 -4.04061,6.31345"></path>
						<path style="fill: none; stroke: black;" d="m 407.34402,81.89119 c 0.62853,3.02856 3.3129,4.10015 5.80837,5.55584"></path>
					</g>
				</svg>
				<div class="col-xs-5 col-sm-4 col-md-4">
					<div class="hidden-xs">
						<p class="h4">Guessed Letters</p>
						<div id="guessedLetters"></div>
					</div>
					<p id="guessesLeft"></p>
					<p style="text-align: center;">
						<button class="btn btn-sm btn-warning" style="margin: 0 5px 5px;" tabindex="1" data-toggle="modal" data-target="#wordDialog">Set word</button>
						<button id="randomWord" class="btn btn-sm btn-warning" style="margin: 0 5px 5px;" tabindex="2" data-loading-text="Loading...">Random Word<span class="hidden-xs"> (Shift + R)</span></button>
					</p>
				</div>
			</div>
			<div id="wordDisplay"></div>
			<div id="guessContainer" class="input-group hidden-xs">
				<input id="guess" maxlength="1" class="form-control" tabindex="3">
				<span class="input-group-btn">
					<button id="submitGuess" class="btn btn-default" tabindex="4" data-trigger="manual" data-container="body" data-toggle="tooltip" data-placement="right" title="Error"><i class="fa fa-arrow-right fa-fw"></i></button>
				</span>
			</div>
			<div id="guessContainer-xs" class="input-group visible-xs-block" style="text-align: center;">
				<span class="guess-xs" data-letter="A">A</span>
				<span class="guess-xs" data-letter="B">B</span>
				<span class="guess-xs" data-letter="C">C</span>
				<span class="guess-xs" data-letter="D">D</span>
				<span class="guess-xs" data-letter="E">E</span>
				<span class="guess-xs" data-letter="F">F</span>
				<span class="guess-xs" data-letter="G">G</span>
				<span class="guess-xs" data-letter="H">H</span>
				<span class="guess-xs" data-letter="I">I</span>
				<span class="guess-xs" data-letter="J">J</span>
				<span class="guess-xs" data-letter="K">K</span>
				<span class="guess-xs" data-letter="L">L</span>
				<span class="guess-xs" data-letter="M">M</span>
				<span class="guess-xs" data-letter="N">N</span>
				<span class="guess-xs" data-letter="O">O</span>
				<span class="guess-xs" data-letter="P">P</span>
				<span class="guess-xs" data-letter="Q">Q</span>
				<span class="guess-xs" data-letter="R">R</span>
				<span class="guess-xs" data-letter="S">S</span>
				<span class="guess-xs" data-letter="T">T</span>
				<span class="guess-xs" data-letter="U">U</span>
				<span class="guess-xs" data-letter="V">V</span>
				<span class="guess-xs" data-letter="W">W</span>
				<span class="guess-xs" data-letter="X">X</span>
				<span class="guess-xs" data-letter="Y">Y</span>
				<span class="guess-xs" data-letter="Z">Z</span>
			</div>
		</div>
		<footer class="footer">
			<nav class="nav">
				<p>Designed and Built by Taha Vasowalla</p>
				<a href="https://www.facebook.com/taha.vasowalla" target="_blank"><i class="fa fa-fw fa-facebook"></i></a>
				<a href="https://www.google.com/+TahaVasowalla/about" target="_blank"><i class="fa fa-fw fa-google-plus"></i></a>
				<a href="http://instagram.com/darkace65/" target="_blank"><i class="fa fa-fw fa-instagram"></i></a>
				<a href="https://www.linkedin.com/in/TahaVasowalla" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a>
				<a href="https://github.com/DarkAce65" target="_blank"><i class="fa fa-fw fa-github"></i></a>
			</nav>
		</footer>
		<script type="text/javascript">
			var hangmanWord = "", guessedLetters = "", guessesLeft = 6;
			var randomWords = [];
			var timeline = new TimelineMax();

			$(".fancyInput input").on("focus", function() {
				$(this.parentNode).addClass("hasText"); // Fancy input is focused
			});

			$(".fancyInput input").on("blur", function() {
				if(this.value === "") {
					$(this.parentNode).removeClass("hasText"); // Fancy input does not contain text
				}
			});

			$(window).on("keypress", function(e) {
				if(e.which == 82 && e.shiftKey) { // Shift + R sets random word
					$("#randomWord").click();
					$("#guess").focus();
					e.preventDefault();
				}
			});

			$("#wordInput").on("keypress", function(e) {
				if(e.which == 13) { // Enter key triggers submit button
					$("#submitWord").click();
				}
				e.stopPropagation();
			});

			$("#guess").on("keypress", function(e) {
				if(e.which == 82 && e.shiftKey) { // Shift + R sets random word
					e.preventDefault();
					$("#randomWord").click();
				}
				if(e.which == 13) { // Enter key triggers submit button
					$("#submitGuess").click();
				}
				e.stopPropagation();
			});

			$("#randomWord").click(function() { // Random word button press
				submitWord(randomWords[Math.floor(Math.random() * randomWords.length)].trim()); // Submit random word
				timeline.clear();
				timeline.to($("#man path, #xEyes path"), 0.2, {drawSVG: "0%"}); // Clear the gallows
			});

			$("#submitWord").click(function() { // Submit button press
				var word = $("#wordInput").val();
				if(word !== "" && !/[^A-Za-z]/.test(word)) { // Check if the word exists and contains valid characters
					$("#wordDialog").modal("hide"); // Close modal
					submitWord(word); // Submit the word
					$("#wordDialog").one("hidden.bs.modal", function() { // When the modal is closed, clear the gallows
						timeline.clear();
						timeline.to($("#man path, #xEyes path"), 0.2, {drawSVG: "0%"});
					});
				}
				else if(word === "") {
					$("#wordDialog").modal("hide"); // Close modal
				}
				else {
					$("#error").show(500); // Show the error message
				}
			});

			$("#submitGuess").click(function() {
				var guessedLetter = $("#guess").val().trim();
				if(hangmanWord !== "" && guessedLetter !== "" && guessesLeft > 0) { // Check if a word is set, guess is not whitespace, and there are guesses left
					guess(guessedLetter.toUpperCase()); // Submit guess
				}
			});

			$(".guess-xs").click(function() {
				if(!$(this).is(".correct, .incorrect") && hangmanWord !== "" && guessesLeft > 0) { // Check if letter has not been guessed, a word is set, and there are guesses left
					guess($(this).data("letter")); // Submit guess
				}
			});

			function submitWord(word) {
				hangmanWord = word.toUpperCase(); // Convert word to uppercase
				guessedLetters = ""; // Clear guessed letters
				guessesLeft = 6; // Set 6 guesses
				$("#guessesLeft").html(guessesLeft + " Guesses left"); // Reset DOM elements
				$("#wordInput").val("");
				$("#wordDisplay").html("");
				$("#guessedLetters").html("");
				$(".fancyInput").removeClass("hasText");
				$(".guess-xs").removeClass("correct incorrect");
				$("#error").hide();
				for(var i = 0; i < word.length; i++) {
					$("#wordDisplay").append('<span class="letter">&emsp;</span>');
				}
			}

			function guess(letter) {
				$("#guess").val("");
				if(hangmanWord !== "" && guessedLetters === "") { // Reset on first guess
					timeline.clear();
					timeline.set($("#man path, #xEyes path"), {drawSVG: "0%"});
				}
				if(letter.match(/[^A-Za-z]/)) { // Invalid guess
					$("#submitGuess").attr("title", "Only letters are allowed.").tooltip("fixTitle").tooltip("show");
					$("#guess").focus();
				}
				else if(guessedLetters.indexOf(letter) != -1) { // Letter already guessed
					$("#submitGuess").attr("title", "You've already guessed this letter.").tooltip("fixTitle").tooltip("show");
					$("#guess").focus();
				}
				else if(guessedLetters.indexOf(letter) == -1) { // Check if letter has not been guessed
					$("#submitGuess").tooltip("hide");
					guessedLetters += letter; // Add guessed letter to guessedLetters
					var offset = 0;
					var index = hangmanWord.indexOf(letter, offset); // Get index of guess in the word
					if(index != -1) { // Guessed letter is in the word
						$(".guess-xs[data-letter='" + letter + "']").addClass("correct");
						while(index != -1) { // While guessed letter is still in word
							var space = $("#wordDisplay .letter")[index]; // Get blank space where letter is
							timeline.to(space, 0.2, {background: "rgba(62, 200, 62, 0.6)"}, timeline.time()); // Green highlight
							timeline.to(space, 0.8, {background: "rgba(62, 200, 62, 0)"}, timeline.time() + 0.2);
							$(space).html(letter); // Set content of blank to the letter
							offset = index + 1;
							index = hangmanWord.indexOf(letter, offset); // Get next occurence of letter
						}
						if($("#wordDisplay").html().replace(/<[^<>]*>/g, "") == hangmanWord) { // Word has been guessed
							guessesLeft = -1;
							swal({
								title: "Hooray!",
								text: "You win!",
								type: "success",
								confirmButtonClass: "btn-success",
								confirmButtonText: "OK"
							});
						}
						else if(window.innerWidth > 767) {
							$("#guess").focus();
						}
					}
					else { // Guessed letter is not in the word
						guessesLeft--;
						$("#guessesLeft").html(guessesLeft + " Guesses left");
						timeline.to($("#man path")[guessesLeft], 1, {drawSVG: "100%", ease: Sine.easeIn}, timeline.time()); // Draw part of man
						var incorrectGuess = $('<span class="letter">' + letter + '</span>');
						$("#guessedLetters").append(incorrectGuess); // Append incorrect guess to the guessed letters section
						timeline.to(incorrectGuess, 0.2, {background: "rgba(200, 62, 62, 0.6)"}, timeline.time()); // Red highlight
						timeline.to(incorrectGuess, 0.8, {background: "rgba(200, 62, 62, 0)"}, timeline.time() + 0.2);
						$(".guess-xs[data-letter='" + letter + "']").addClass("incorrect");
						if(guessesLeft === 0) { // Out of guesses
							var guessedWord = $("#wordDisplay").html().replace(/<[^<>]*>/g, "");
							timeline.staggerFromTo($("#xEyes path"), 0.25, {drawSVG: "0%"}, {drawSVG: "100%"}, 0.25); // X-ed out eyes
							for(var i = 0; i < hangmanWord.length; i++) { // Get blank spaces
								if(/\s/.test(guessedWord.charAt(i))) {
									var space = $("#wordDisplay .letter")[i];
									$(space).html(hangmanWord.charAt(i)); // Set blank to correct letter
									timeline.to(space, 0.2, {background: "rgba(200, 62, 62, 0.6)", color: "red", "border-color": "red"}, timeline.time()); // Red highlight
									timeline.to(space, 0.8, {background: "rgba(200, 62, 62, 0)"}, timeline.time() + 0.2);
								}
							}
						}
						else {
							$("#guess").focus();
						}
					}
				}
			}

			$("#randomWord").button("loading");

			$.ajax({ // Load random word list (55,042 words)
				type: "GET",
				url: "wordlist.txt",
				dataType: "text",
				success: function(response) {
					randomWords = response.split('\n');
					$("#randomWord").button("reset");
				},
				error: function() {
					$("#randomWord").remove();
				}
			});

			timeline.fromTo($("path"), 1, {drawSVG: "0%"}, {drawSVG: "100%"}); // Initial drawing of gallows
		</script>
	</body>
</html>