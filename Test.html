<!DOCTYPE html>
<html>
	<head>
		<title>Experimental</title>
		<link rel="shortcut icon" href="img/icons/TV.png"/>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="font-awesome.min.css"/>
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<script src="bower_components/three.js/build/three.js"></script>
		<script src="GSAP/TweenMax.min.js"></script>
		<script src="TrackballControls.js"></script>
		<style type="text/css">
			html, body {
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<div id="rendererContainer"></div>
		<script id="vertexShader" type="x-shader/x-vertex">
			varying vec2 vUv;

			void main() {
				vUv = uv;
				vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
				gl_Position = projectionMatrix * mvPosition;
			}
		</script>
		<script id="fragmentShader" type="x-shader/x-fragment">
			uniform float u_time;
			uniform vec2 u_resolution;

			uniform sampler2D u_bgMap;

			varying vec2 vUv;

			void main() {
				vec2 st = vUv;
				vec4 tex = texture2D(u_bgMap, st);

				vec3 color = tex.rgb;

				gl_FragColor = vec4(color, 1.0);
			}
		</script>
		<script type="text/javascript">
			window.requestAnimFrame =
				window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				window.oRequestAnimationFrame ||
				window.msRequestAnimationFrame ||
				function(callback) {
					window.setTimeout(callback, 1000 / 60);
				};

			var loader = new THREE.TextureLoader();
			var clock = new THREE.Clock();
			var scene = new THREE.Scene();
			var renderer = new THREE.WebGLRenderer({alpha: true, antialias: true});
			$("#rendererContainer").append(renderer.domElement);
			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.setClearColor(0x000000);
			renderer.setPixelRatio(window.devicePixelRatio);

			var camera = new THREE.Camera();
			camera.position.set(0, 0, 1);
			scene.add(camera);

			var uniforms = {
				u_time: {type: "f", value: 0},
				u_resolution: {type: "v2", value: new THREE.Vector2()},
				u_bgMap: {type: "t", value: null}
			};
			var material = new THREE.ShaderMaterial({
				uniforms: uniforms,
				vertexShader: document.getElementById("vertexShader").textContent,
				fragmentShader: document.getElementById("fragmentShader").textContent,
				transparent: true,
				side: THREE.DoubleSide
			});
			var objectGeometry = new THREE.PlaneGeometry(2, 2);
			var object = new THREE.Mesh(objectGeometry, material);
			scene.add(object);

			function render() {
				requestAnimFrame(render);
				renderer.render(scene, camera);
				uniforms.u_time.value += clock.getDelta();
			}

			loader.load("img/placeholder/Volcano.jpg", function(texture) {
				uniforms.u_bgMap.value = texture;
				uniforms.u_bgMap.value.wrapS = THREE.RepeatWrapping;
				uniforms.u_bgMap.value.wrapT = THREE.RepeatWrapping;
			});
			render();

			$(window).resize(function() {
				renderer.setSize(window.innerWidth, window.innerHeight);
				uniforms.u_resolution.value.x = renderer.domElement.width;
				uniforms.u_resolution.value.y = renderer.domElement.height;
			});

			$(window).load(function() {
				renderer.setSize(window.innerWidth, window.innerHeight);
				uniforms.u_resolution.value.x = renderer.domElement.width;
				uniforms.u_resolution.value.y = renderer.domElement.height;
			});
		</script>
	</body>
</html>